---
title: Producer-Consumer Problem
description: This may or may not have been copied from an old OOP Lab.
pubDate: 08-29-2024
---

## Source Code

```java
import java.util.ArrayList;

class Buffer {
	private ArrayList<Integer> list = new ArrayList<>();
	private int capacity;

	public Buffer(int capacity) {
		this.capacity = capacity;
	}

	public synchronized void produce(int item) {
		while (list.size() == capacity) {
			try {
				wait(); // Wait if the buffer is full
			} catch (InterruptedException e) {
				e.printStackTrace();
			}
		}

		list.add(item);
		System.out.println("Produced: " + item);

		notify(); // Notify waiting consumer
	}

	public synchronized int consume() {
		while (list.isEmpty()) {
			try {
				wait(); // Wait if the buffer is empty
			} catch (InterruptedException e) {
				e.printStackTrace();
			}
		}

		int item = list.remove(0);
		System.out.println("Consumed: " + item);

		notify(); // Notify waiting producer

		return item;
	}
}

class Producer implements Runnable {
	private Buffer buffer;

	public Producer(Buffer buffer) {
		this.buffer = buffer;
	}

	@Override
	public void run() {
		for (int i = 1; i <= 5; i++) {
			buffer.produce(i);
			try {
				Thread.sleep(1000);
			} catch (InterruptedException e) {
				e.printStackTrace();
			}
		}
	}
}

class Consumer implements Runnable {
	private Buffer buffer;

	public Consumer(Buffer buffer) {
		this.buffer = buffer;
	}

	@Override
	public void run() {
		for (int i = 0; i < 5; i++) {
			buffer.consume();
			try {
				Thread.sleep(1000);
			} catch (InterruptedException e) {
				e.printStackTrace();
			}
		}
	}
}

public class ProducerConsumer {
	public static void main(String[] args) {
		Buffer buffer = new Buffer(5);

		Thread producerThread = new Thread(new Producer(buffer));
		Thread consumerThread = new Thread(new Consumer(buffer));

		producerThread.start();
		consumerThread.start();
	}
}
```

## Output

```
Produced: 1
Consumed: 1
Produced: 2
Consumed: 2
Produced: 3
Consumed: 3
Produced: 4
Consumed: 4
Produced: 5
Consumed: 5
```
